# filter and annotate panelses CNVs

# enable bedtools
module load bedtools

# case IDs
SAMPLES="15-015 12-168 08-307 12-098 13-131 10264 08-209 09-051 09-143 09-308 10-198 11-065 11-246 12-260 13-196 14-223 10037  16-004 10339  10379  10460  10532  10432  09-175 10524  10806  10377  10349  10355  11-328 10611  11-237 13-285 10-232 11013  09-296 10202  11-257 09-019 10969  10759  10888  11-313 08-271 14-074 11042  10541  10421  11-171 15-019 14-103 10480  14-144 10-191 10-188 09-088 11-299 14-283 09-024 13-223 10452  11-255 09-162 09-120 09-043 10932  12-033 12-153 12-236 10666  10267  11253  13-092 10289  10376  08-186 09-004 13-007 14-024 10216  10034  10399  10369  13-271 15-148 14-055 12-213 13-111 10219  15-224 15-176 11025  13-112 10-055 13-226 10634  15-264 10-308 08-212 15-123 12-040 12-215 13-011 10704  13-270 10230  10416  11019  15-182 12-245 12-017 11-212 10-095 09-121 14-070 15-145 13-246 10-059 11-098 10-234 13-128 10-291 13-236 10-235 10469  10-333 13-214 13-187 10968  12-225 12-126 15-010 10855  08-304 10372  15-106 10-113 13-069 12-038 10-223 10213  10954  10274  14-254 11-317 13-185 14-091 12-180 10-263 12-014 10092  12-216 15-223 09-185 14-046 11-290 10-192 12-154 10279  10812  10-175 12-264 11-263 12-256 11-067 10-127 10520  14-161 15-254 12-063 10345  14-202 10-126 10470  13-197 14-211 11-245 10104  11-236 15-001 10685  14-284 12-200 10035  08-219 15-149 10-025 13-115 13-184 15-228 10366  13-171 13-018 10400  13-137 11-244 10746  13-050 15-155 10534  15-139 14-087 12-227 10882  10446  12-128 12-234 15-150 10-210 12-130 13-078 14-044 09-215 10127  11016  14-251 14-023 10346  08-297 08-286 08-204 09-036 10323  10060  10-331 10-024 10044  10-064 15-196 12-261 14-258 10-217 11-165 10-047 10178  11-189 14-239 10660  12-179 15-208 09-119 10747  12-222 08-222 13-061 13-016 10-026 13-191 15-048 13-155 10082  10348  14-128 14-220 10817  12-258 10461  10-078 13-101 09-191 14-250 10933"

# blacklist filtering
# discarding events if they overlap 50% or more with a blacklist region
for s in ${SAMPLES}; do bedtools subtract -a ${s}.CNVs.bed -b hg19-blacklist.v2.mod.bed -f 0.5 -A > ${s}.CNVs.filt.bed; done

# running AnnotSV
for s in ${SAMPLES}; do AnnotSV/bin/AnnotSV -SVinputFile ${s}.CNVs.filt.bed -outputFile ${s}.CNV.annotated -svtBEDcol 4 -REreport 1 -genomeBuild GRCh37; done
